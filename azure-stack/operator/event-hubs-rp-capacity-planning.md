---
title: 如何在 Azure Stack 中心为事件中心执行容量规划
description: 了解如何在 Azure Stack 集线器上规划事件中心资源提供程序的容量。
author: BryanLa
ms.author: bryanla
ms.service: azure-stack
ms.topic: how-to
ms.date: 12/09/2019
ms.reviewer: jfggdl
ms.lastreviewed: 12/09/2019
ms.openlocfilehash: 7eb9dce19bb25367181b17d3f13ada5ed12eff5d
ms.sourcegitcommit: dd53af1b0fc2390de162d41e3d59545d1baad1a7
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/31/2020
ms.locfileid: "80424000"
---
# <a name="how-to-do-capacity-planning-for-event-hubs-on-azure-stack-hub"></a>如何在 Azure Stack 中心为事件中心执行容量规划

[!INCLUDE [preview-banner](../includes/event-hubs-preview.md)]

作为操作员，你可以使用资源[配额](azure-stack-quota-types.md)管理 Azure Stack 集线器容量。 可以通过设置事件中心群集使用的最大核心数配额，来控制事件中心资源的消耗。 事件中心群集是在用户部署事件中心资源时创建的。 本文还介绍了资源提供程序的各种资源消耗要求。

## <a name="cluster-resource-consumption"></a>群集资源消耗

要了解事件中心部署的容量消耗情况，请务必注意，用户基于容量单位（Cu）创建事件中心群集。 它们不会在创建事件中心群集时指定 CPU 核心计数。 但每个 CU 会直接映射到使用的特定内核数。 

用户需要创建 Cu 的事件中心群集，以满足其业务需求。 若要在配额配置上通知你的决定，下表显示了：
- 1 CU 事件中心群集使用的内核总数。
- 使用其他资源（包括 VM 存储、内存和存储帐户）所需的近似容量。

| | VM 类型 | 群集节点 | 每个 VM/节点的内核数 | 内核总数 | VM 存储 | 内存 | 存储帐户 |
|-|---------|-------|-------------------|-------------|------------|--------|------------------|
| **1 CU 事件中心群集** | [D11_V2](../user/azure-stack-vm-sizes.md#mo-dv2) | 5 | 2 | 10 | 500 GiB | 70 GiB | 4 |

所有事件中心群集都对其节点使用[D11_V2](../user/azure-stack-vm-sizes.md#mo-dv2) VM 类型。 D11_V2 的 VM 类型由2个核心组成。 因此1个 CU 事件中心群集使用5个 D11_V2 Vm，这将转换为使用的10个核心。 若要确定要为配额配置的内核数，请使用 1 CU 使用的总内核数的倍数。 此计算反映了创建事件中心群集时允许用户使用的最大 CU 计数。 例如，若要配置允许用户创建具有 2 Cu 容量的群集的配额，请将配额设置为20个内核。

> [!NOTE]
> **仅限公共预览版**Azure Stack 集线器上的事件中心的可用版本仅支持创建1个 CU 群集。 事件中心的公开发布（GA）版本将支持不同的 CU 配置选项。

## <a name="resource-provider-resource-consumption"></a>资源提供程序资源消耗  

事件中心资源提供程序的资源消耗是恒定的，与用户创建的群集的数量或大小无关。 下表显示了 Azure Stack 集线器上的事件中心资源提供程序的核心利用率，以及其他资源占用的资源。 事件中心资源提供程序为其部署使用[D2_V2](/user/azure-stack-vm-sizes#dv2-series)的 VM 类型。

|                                  | VM 类型 | 群集节点 | 核心数 | VM 存储 | 内存 | 存储帐户 |
|----------------------------------|---------|-------|-------|------------|--------|------------------|
| **事件中心资源提供程序** | D2_V2   | 3     | 6     | 300 GiB    | 21 GiB | 2                |

> [!IMPORTANT]
> 资源提供程序消耗不是由配额控制的内容。 你不需要在配额配置中容纳资源提供程序使用的内核数。 资源提供程序是使用管理员订阅进行安装的。 在安装所需的资源提供程序时，订阅不会对操作员施加资源消耗限制。

## <a name="total-resource-consumption"></a>总资源消耗

事件中心服务使用的总容量包括资源提供程序所消耗的资源，以及用户创建的群集的消耗。

下表显示了不同配置下的事件中心消耗总数，而不考虑它们是否由配额管理。 这些数字基于上面提供的资源提供程序和事件中心群集使用量。 使用这些示例，你可以轻松地计算其他部署大小的总 Azure Stack 中心使用量。

|                                      | 核心数 | VM 存储 | 内存  | 存储帐户 | 总存储 |
|--------------------------------------|-------|------------|---------|------------------|---------------|
| **1-CU 群集 + 资源提供程序** | 16    | 800 GiB    | 91 GiB  | 6                | 变量\*    |
| **2-CU 群集 + 资源提供程序** | 26    | 1.3 TB     | 161 GiB | 10               | 变量\*    |
| **4-CU 群集 + 资源提供程序** | 46    | 2.3 TB     | 301 GiB | 18               | 变量\*    |

\* 入口数据块（消息/事件）速率和消息保留是对事件中心群集使用的存储有两个重要因素。 例如，如果在创建事件中心时将消息保留期设置为7天，并且消息将以 1MB/s 速率引入，则使用的近似存储为 604 GB （1 MB x 60 秒 x 60 分钟 x 24 小时 X 7 天）。 如果以 20MB/秒的速率发送消息，并且保留7天，则大致的存储使用量是12TB。 请确保考虑数据速率和保留时间，以充分了解存储容量消耗。

## <a name="next-steps"></a>后续步骤

在开始安装过程之前，请完成[在 Azure Stack 集线器上安装事件中心的先决条件](event-hubs-rp-prerequisites.md)。





