---
title: 在 Azure Stack 集线器上规划事件中心的容量
description: 了解如何针对 Azure Stack Hub 上的事件中心资源提供程序来规划容量。
author: BryanLa
ms.author: bryanla
ms.service: azure-stack
ms.topic: how-to
ms.date: 12/09/2019
ms.reviewer: jfggdl
ms.lastreviewed: 12/09/2019
ms.openlocfilehash: ec369d8f01ed9dc5e6e5635af4922ef80736c4c5
ms.sourcegitcommit: 3e2460d773332622daff09a09398b95ae9fb4188
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/15/2020
ms.locfileid: "90572147"
---
# <a name="how-to-do-capacity-planning-for-event-hubs-on-azure-stack-hub"></a>如何针对 Azure Stack Hub 上的事件中心进行容量规划

[!INCLUDE [preview-banner](../includes/event-hubs-preview.md)]

作为操作员，你可以对资源使用[配额](azure-stack-quota-types.md)，通过这种方式管理 Azure Stack Hub 容量。 可以针对事件中心群集使用的最大核心数设置配额，来控制事件中心资源的消耗。 事件中心群集是用户在部署事件中心资源时创建的。 资源提供程序也有各种资源消耗需求，本文对此进行了介绍。

## <a name="cluster-resource-consumption"></a>群集资源消耗

为了了解进行事件中心部署时的容量消耗情况，必须注意用户是基于容量单位 (CU) 创建事件中心群集的。 用户不会在创建事件中心群集时指定 CPU 核心计数。 但是，每个 CU 会直接映射到特定数目的已使用核心。 

用户需要创建具有满足其业务需求的 CU 数目的事件中心群集。 下表显示的内容有助于你进行配额配置决策：
- 单 CU 事件中心群集使用的总核心数。
- 使用其他资源（包括 VM 存储、内存和存储帐户）时所需的大致容量。

| | VM 类型 | 群集节点数 | 每个 VM/节点的核心数 | 核心总数 | VM 存储 | 内存 | 存储帐户 | 公共 IP |
|-|---------|-------|-------------------|-------------|------------|--------|------------------|---|
| **单 CU 事件中心群集** | [D11_V2](../user/azure-stack-vm-sizes.md#mo-dv2) | 5 | 2 | 10 个 | 500 GiB | 70 GiB | 4 | 1 |

所有事件中心群集都对其节点使用 [D11_V2](../user/azure-stack-vm-sizes.md#mo-dv2) VM 类型。 D11_V2 VM 类型包含 2 个核心。 因此，单 CU 事件中心群集使用 5 个 D11_V2 VM，这相当于使用 10 个核心。 请使用单 CU 所用总核心数的倍数来确定要为某个配额配置的核心数。 此计算反映了当用户创建事件中心群集时可以使用的最大 CU 计数。 例如，若要配置一个配额，允许用户创建容量为 2 个 CU 的群集，请将配额设置为 20 个核心。

> [!NOTE]
> **仅针对公共预览版**：Azure Stack Hub 上提供的事件中心版本只支持创建单 CU 群集。 事件中心的正式发布 (GA) 版会支持各种不同的 CU 配置选项。

## <a name="resource-provider-resource-consumption"></a>资源提供程序的资源消耗  

事件中心资源提供程序的资源消耗是恒定的，与用户创建的群集的数量或大小无关。 下表显示了 Azure Stack Hub 上的事件中心资源提供程序使用的核心数量，以及其他资源的大致消耗量。 事件中心资源提供程序对其部署使用 [D2_V2](../user/azure-stack-vm-sizes.md#dv2-series) VM 类型。

|                                  | VM 类型 | 群集节点数 | 核心数 | VM 存储 | 内存 | 存储帐户 | 公共 IP |
|----------------------------------|---------|---------------|-------|------------|--------|------------------|------------|
| **事件中心资源提供程序** | D2_V2   | 3     | 6     | 300 GiB | 21 GiB | 2 | 1 |

> [!IMPORTANT]
> 资源提供程序的资源消耗不由配额控制。 你不需要在你的配额配置中提供由资源提供程序使用的核心。 资源提供程序是使用管理员订阅进行安装的。 该订阅不会在操作员安装所需的资源提供程序时对操作员施加资源消耗限制。

## <a name="total-resource-consumption"></a>资源总消耗量

事件中心服务消耗的总容量包括资源提供程序消耗的资源，以及用户创建的群集消耗的资源。

下表显示了不同配置下事件中心的总消耗量，不管它们是否受配额控制。 这些数字基于上面提供的资源提供程序和事件中心群集的资源消耗量。 对于其他部署大小，你可以根据这些示例轻松地计算出 Azure Stack Hub 的总使用量。

|                                      | 核心数 | VM 存储 | 内存  | 存储帐户 | 总存储\* | 公共 IP\*\* |
|--------------------------------------|-------|------------|---------|------------------|---------------|------------|
| **单 CU 群集 + 资源提供程序** | 16    | 800 GiB    | 91 GiB  | 6                | 可变    | 2 |
| **双 CU 群集 + 资源提供程序** | 26    | 1.3 TB     | 161 GiB | 10 个               | 可变    | 2 |
| **四 CU 群集 + 资源提供程序** | 46    | 2.3 TB     | 301 GiB | 18               | 可变    | 2 |

\* 数据块（消息/事件）引入速率和消息保留期是影响事件中心群集所用存储的两个重要因素。 例如，如果在创建事件中心时将消息保留期设置为 7 天，且消息的引入速率为 1MB/秒，则使用的存储大约为 604 GB（1 MB x 60 秒 x 60 分钟 x 24 小时 x 7 天）。 如果消息发送速率为 20MB/秒，且保留期为 7 天，则存储消耗量大约为 12TB。 请务必考虑数据流入速率和保留时间，这样才能充分了解存储容量的消耗情况。

\*\* 使用的公共 IP 地址来自[作为订阅的一部分提供的网络配额](azure-stack-quota-types.md#network-quota-types)。

## <a name="next-steps"></a>后续步骤

在开始安装过程之前，请完成[在 Azure Stack Hub 上安装事件中心的先决条件](event-hubs-rp-prerequisites.md)一文中的操作。
